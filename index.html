<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Reality-Bending OS - Prototype</title>
  <link rel="stylesheet" href="css/core/base.css">
  <link id="theme-stylesheet" rel="stylesheet" href="css/themes/windows95.css">
  <script>
    // Dynamic theme loading based on OS version
    window.loadTheme = function(themeName) {
      const themeLink = document.getElementById('theme-stylesheet');
      themeLink.href = `css/themes/${themeName}.css`;
    };
  </script>
</head>
<body>
  <div id="desktop-root"></div>

  <script>
    // Basic boot log
    console.log('RBOS: booting (index.html)');
  </script>

  <script src="js/core/event-system.js"></script>
  <script src="js/core/game-engine.js"></script>
  <script src="js/core/os-manager.js"></script>
  <script src="js/core/file-system.js"></script>
  <script src="js/core/window-manager.js"></script>
  <script src="js/core/save-manager.js"></script>
  <script src="js/core/content-loader.js"></script>
  <script src="js/core/plugin-manager.js"></script>

  <!-- UI and apps (must load before engine start so plugins register) -->
  <script src="js/ui/desktop-shell.js?v=3&t=1733751600"></script>
  <script src="js/ui/start-menu.js?v=5&t=1733752200"></script>
  <script src="js/ui/test-menu.js?v=3&t=1733751600"></script>

  <script src="js/apps/base-app.js"></script>
  <script src="js/apps/explorer.js"></script>
  <script src="js/apps/notepad.js"></script>
  <script src="js/apps/email.js"></script>
  
  <!-- New functional apps -->
  <script src="js/apps/calculator.js"></script>
  <script src="js/apps/paint.js"></script>
  <script src="js/apps/solitaire.js"></script>
  <script src="js/apps/control-panel.js"></script>
  <script src="js/apps/file-explorer.js"></script>
  <script src="js/apps/text-editor.js"></script>
  
  <!-- Multimedia apps -->
  <script src="js/apps/media-player.js"></script>
  <script src="js/apps/sound-recorder.js"></script>
  
  <!-- Additional games -->
  <script src="js/apps/minesweeper.js"></script>
  
  <!-- System applications -->
  <script src="js/apps/my-computer.js"></script>
  <script src="js/apps/internet-explorer.js"></script>

  <script>
    // Start the engine
    if (window.GameEngine) {
      window.GameEngine.start();
    } else {
      console.warn('RBOS: GameEngine not available');
    }
    
    // Add manual theme switching for testing
    window.switchTheme = function(themeName) {
      console.log('Manual theme switch to:', themeName);
      if (window.FORCE_THEME_SWITCH) {
        window.FORCE_THEME_SWITCH(themeName, themeName);
      } else {
        console.log('FORCE_THEME_SWITCH not available yet, trying direct method');
        const link = document.getElementById('theme-stylesheet');
        if(link) {
          link.href = `css/themes/${themeName}.css?cb=${Date.now()}`;
        }
        const root = document.getElementById('desktop-root');
        if (root) {
          Array.from(root.classList).filter(c => c.startsWith('theme-')).forEach(c => root.classList.remove(c));
          root.classList.add('theme-' + themeName);
          console.log('Applied theme class:', 'theme-' + themeName);
        }
      }
    };
    
    console.log('Manual theme switching available. Try: switchTheme("win10"), switchTheme("winxp"), switchTheme("win11"), etc.');
  </script>
</body>
</html>
